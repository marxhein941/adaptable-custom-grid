/* Grid Change Tracker Styles */

.grid-change-tracker-container {
    display: flex;
    flex-direction: column;
    width: 100%;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    /* Removed height: 100% to allow content to determine height */
    /* This ensures the footer is always visible without needing to scroll the entire control */
}

/* Column Header Tooltip Styles */
.column-header-container {
    display: flex;
    flex-direction: column;
    width: 100%;
}

.column-header-title {
    display: flex;
    align-items: center;
    cursor: pointer;
}

.column-name {
    font-weight: 600;
    color: #323130;
}

.column-info-icon {
    margin-left: 4px;
    font-size: 12px;
    color: #605e5c;
    vertical-align: middle;
    cursor: help;
}

/* Enhanced Tooltip Styles */
.ms-Tooltip {
    max-width: 400px !important;
}

.ms-Tooltip-content {
    padding: 8px 12px;
    background-color: #ffffff;
    box-shadow: 0 3.2px 7.2px rgba(0, 0, 0, 0.132), 0 0.6px 1.8px rgba(0, 0, 0, 0.108);
    border-radius: 4px;
}

.ms-Callout-main {
    background-color: #ffffff;
    border-radius: 4px;
}

.grid-change-tracker-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 12px;
    background-color: #ffffff;
    border-bottom: 1px solid #edebe9;
}

.grid-change-tracker-title {
    font-size: 14px;
    font-weight: 600;
    color: #323130;
}

.grid-change-tracker-actions {
    display: flex;
    gap: 8px;
}

.grid-content {
    /* Set max height to show approximately 12 rows plus header */
    /* Row height ~42px + header ~42px = ~546px total */
    max-height: 546px;
    overflow-x: auto;
    overflow-y: auto;
    width: 100%;
    flex-shrink: 0;
    position: relative;
}

/* Custom sticky header wrapper */
.custom-sticky-header {
    position: sticky;
    top: 0;
    z-index: 100;
    background-color: #f3f2f1;
    border-bottom: 2px solid #323130;
    overflow-x: auto;
    overflow-y: hidden;
}

/* Hide scrollbar for custom header to prevent double scrollbars */
.custom-sticky-header::-webkit-scrollbar {
    height: 0px;
}

/* Custom header row (column names) */
.custom-header-row {
    display: flex;
    flex-direction: row;
    background-color: #f3f2f1;
    border-bottom: 1px solid #edebe9;
    min-width: fit-content;
    width: max-content;
}

.custom-header-cell {
    padding: 8px 12px;
    display: flex;
    align-items: center;
    flex-shrink: 0;
    flex-grow: 0;
    box-sizing: border-box;
    border-right: 1px solid #c8c6c4;
    font-weight: 600;
    font-size: 14px;
    color: #323130;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.2s ease;
    overflow: hidden;
}

.custom-header-cell:hover {
    background-color: #edebe9;
}

.custom-header-cell:last-child {
    border-right: none;
}

/* Custom filter row */
.custom-filter-row {
    display: flex;
    flex-direction: row;
    background-color: #faf9f8;
    min-width: fit-content;
    width: max-content;
}

.custom-filter-cell {
    padding: 4px 8px;
    display: flex;
    align-items: center;
    position: relative;
    flex-shrink: 0;
    flex-grow: 0;
    box-sizing: border-box;
    border-right: 1px solid #c8c6c4;
}

.custom-filter-cell:last-child {
    border-right: none;
}

/* Grid body wrapper */
.grid-body {
    overflow-x: auto;
    overflow-y: auto;
    max-height: calc(546px - 84px); /* Total height minus header and filter row height */
}

/* Custom data rows */
.custom-data-rows {
    min-width: fit-content;
    width: max-content;
}

.custom-data-row {
    display: flex;
    flex-direction: row;
    min-width: fit-content;
    width: max-content;
    border-bottom: 1px solid #c8c6c4;
}

.custom-data-row:hover {
    background-color: #f3f2f1;
}

.custom-data-cell {
    display: flex;
    align-items: stretch;
    flex-shrink: 0;
    flex-grow: 0;
    box-sizing: border-box;
    border-right: 1px solid #c8c6c4;
}

.custom-data-cell:last-child {
    border-right: none;
}

/* Ensure DetailsList respects horizontal scrolling */
.grid-content .ms-DetailsList {
    min-width: 100%;
    width: max-content;
}

/* Remove DetailsList's default cell padding to match our custom header */
.grid-content .ms-DetailsRow-cell {
    padding: 0 !important;
    margin: 0 !important;
}

/* Ensure DetailsList cells have exact width matching headers */
.grid-content .ms-DetailsRow-cell > div {
    width: 100% !important;
    height: 100% !important;
}

/* Smooth scrollbar styling */
.grid-content::-webkit-scrollbar {
    height: 12px;
    width: 12px;
}

.grid-content::-webkit-scrollbar-track {
    background-color: #f3f2f1;
    border-radius: 10px;
}

.grid-content::-webkit-scrollbar-thumb {
    background-color: #c8c6c4;
    border-radius: 10px;
    border: 2px solid #f3f2f1;
}

.grid-content::-webkit-scrollbar-thumb:hover {
    background-color: #a19f9d;
}

/* Prevent column headers from wrapping */
.grid-content .ms-DetailsHeader-cellTitle {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Changed cell styling */
.changed-cell {
    position: relative;
    font-weight: 600;
}

.changed-cell-input {
    border: 1px solid #0078d4 !important;
}

.change-indicator {
    color: #d13438;
    margin-right: 4px;
    font-weight: bold;
}

/* Aggregation footer styling */
.aggregation-footer {
    border-top: 2px solid #323130;
    background-color: #ffffff;
    font-weight: 600;
    overflow-x: auto;
    overflow-y: hidden;
    position: relative;
}

/* Hide scrollbar for footer to prevent double scrollbars */
.aggregation-footer::-webkit-scrollbar {
    height: 0px;
    width: 0px;
}

.aggregation-footer-row {
    display: flex;
    flex-direction: row;
    min-width: fit-content;
    width: max-content;
}

.aggregation-cell {
    padding: 8px 12px;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    flex-shrink: 0;
    flex-grow: 0;
    box-sizing: border-box;
    border-right: 1px solid #c8c6c4;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    position: relative;
}

.aggregation-cell:last-child {
    border-right: none;
}

.aggregation-value {
    font-size: 14px;
    color: #323130;
    font-weight: 600;
}

.aggregation-empty {
    font-size: 14px;
    color: #a19f9d;
    font-weight: 400;
}

/* Save button styling */
.save-button {
    background-color: #0078d4;
    color: white;
    border: none;
    padding: 6px 16px;
    border-radius: 2px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background-color 0.2s;
}

.save-button:hover {
    background-color: #106ebe;
}

.save-button:disabled {
    background-color: #c8c6c4;
    cursor: not-allowed;
}

/* Status indicator */
.status-indicator {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    color: #605e5c;
}

.changes-count {
    padding: 2px 8px;
    background-color: #fef0cd;
    border-radius: 10px;
    font-weight: 600;
    color: #323130;
}

/* Loading spinner */
.loading-spinner {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
}

/* Error message */
.error-message {
    background-color: #fde7e9;
    border: 1px solid #d13438;
    color: #a4262c;
    padding: 8px 12px;
    margin: 8px 12px;
    border-radius: 2px;
    font-size: 12px;
}

/* Success message */
.success-message {
    background-color: #dff6dd;
    border: 1px solid #107c10;
    color: #107c10;
    padding: 8px 12px;
    margin: 8px 12px;
    border-radius: 2px;
    font-size: 12px;
}

/* Cell editor styling */
.cell-editor {
    width: 100%;
    border: 1px solid #8a8886;
    padding: 4px 8px;
    font-size: 14px;
    font-family: inherit;
}

.cell-editor:focus {
    outline: none;
    border-color: #0078d4;
    box-shadow: 0 0 0 1px #0078d4;
}

/* Editable cell hover effect */
.editable-cell:hover {
    background-color: #f3f2f1;
    cursor: pointer;
}

/* Read-only cell styling */
.readonly-cell {
    background-color: #f3f2f1 !important;
    cursor: not-allowed !important;
    user-select: none !important;
    pointer-events: auto !important;
}

.readonly-cell:hover {
    background-color: #edebe9 !important;
}

.readonly-cell * {
    pointer-events: none !important;
    cursor: not-allowed !important;
    user-select: none !important;
}

.readonly-text {
    display: inline-block;
    width: 100%;
    padding: 6px 8px;
    color: #605e5c !important;
    font-size: 14px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-style: italic !important;
    pointer-events: none !important;
}

/* Enhanced focus styles for selected/editing cell */
.editable-cell:focus-within,
.changed-cell:focus-within {
    outline: 2px solid #0078d4;
    outline-offset: -2px;
    background-color: #f3f9fd;
    box-shadow: 0 0 8px rgba(0, 120, 212, 0.3);
    position: relative;
    z-index: 1;
}

.editable-cell input:focus,
.changed-cell input:focus {
    outline: none;
}

/* Additional highlight for TextField when focused */
.editable-cell .ms-TextField-fieldGroup:focus-within,
.changed-cell .ms-TextField-fieldGroup:focus-within {
    border-color: transparent !important;
}

/* Column header styling */
.column-header-title {
    font-size: 14px;
    font-weight: 600;
    color: #323130;
    padding: 4px 0;
    cursor: pointer;
    transition: color 0.2s ease;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.column-header-title:hover {
    color: #0078d4;
}

/* Filter count indicator */
.filter-count {
    margin-left: 8px;
    font-size: 12px;
    font-weight: normal;
    color: #0078d4;
    background-color: #deecf9;
    padding: 2px 8px;
    border-radius: 10px;
}

/* Deployment timestamp indicator */
.deployment-timestamp {
    margin-left: 12px;
    font-size: 10px;
    font-weight: normal;
    color: #605e5c;
    background-color: #edebe9;
    padding: 2px 6px;
    border-radius: 3px;
    font-family: 'Consolas', 'Courier New', monospace;
}

/* Sort indicator styling */
.ms-DetailsHeader-cellTitle {
    cursor: pointer;
}

.ms-DetailsHeader-cellTitle:hover {
    background-color: #edebe9;
}

/* Tooltip styling - scoped to component only */
.grid-change-tracker-container .ms-Tooltip,
.grid-change-tracker-container .ms-Tooltip *,
.grid-change-tracker-container .ms-TooltipHost .ms-Callout,
.grid-change-tracker-container .ms-Callout,
.grid-change-tracker-container .ms-Callout-main,
.grid-change-tracker-container .ms-Layer .ms-Callout-main {
    background-color: #edebe9 !important;
    color: #000000 !important;
}

.grid-change-tracker-container .ms-Tooltip .ms-Callout-main {
    max-width: 400px !important;
    padding: 8px 12px !important;
    background-color: #edebe9 !important;
    color: #000000 !important;
    font-size: 14px !important;
    font-weight: 600 !important;
    line-height: 1.4 !important;
    border-radius: 2px !important;
    border: 1px solid #8a8886 !important;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15) !important;
}

.grid-change-tracker-container .ms-Tooltip .ms-Callout-beak,
.grid-change-tracker-container .ms-Callout-beak,
.grid-change-tracker-container .ms-Callout-beakCurtain {
    background-color: #edebe9 !important;
}

/* Override any theme colors - scoped to component only */
.grid-change-tracker-container div[class*="ms-Callout"] {
    background-color: #edebe9 !important;
    color: #000000 !important;
}

.grid-change-tracker-container div[class*="ms-Tooltip"] {
    background-color: #edebe9 !important;
    color: #000000 !important;
}

/* Column header tooltip enhancements */
.column-info-icon {
    cursor: help;
    transition: opacity 0.2s, color 0.2s;
    opacity: 0.6;
}

.column-header-title:hover .column-info-icon {
    opacity: 1 !important;
    color: #0078d4 !important;
}

.column-name {
    cursor: default;
}

.column-header-title:has(.column-info-icon) .column-name {
    border-bottom: 1px dotted #8a8886;
    cursor: help;
}

/* Column resizing styles */
.ms-DetailsHeader-cellSizer {
    cursor: col-resize !important;
}

.ms-DetailsHeader-cellSizer:hover {
    background: #0078d4;
    opacity: 0.5;
}

/* Ensure proper column header cell positioning for resize handles */
.ms-DetailsHeader-cell {
    position: relative;
}

/* Visual feedback during resize */
.ms-DetailsList.is-resizing {
    cursor: col-resize !important;
    user-select: none !important;
}

.ms-DetailsList.is-resizing * {
    cursor: col-resize !important;
    user-select: none !important;
}

/* Smooth transition for column width changes */
.custom-header-cell,
.custom-filter-cell {
    transition: width 0.15s ease-out;
}

/* Ensure headers don't wrap during resize */
.custom-header-cell .column-name {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Row-level disabled state styling - matches disabled column styling */
.custom-data-row.row-disabled {
    background-color: #f3f2f1 !important;
}

.custom-data-row.row-disabled:hover {
    background-color: #edebe9 !important;
}

.custom-data-row.row-disabled .custom-data-cell {
    background-color: #f3f2f1 !important;
}

/* Enhanced visual indicator for row-level disabled cells */
.custom-data-row.row-disabled .readonly-cell {
    background-color: #f3f2f1 !important;
}

.custom-data-row.row-disabled .readonly-text {
    color: #605e5c !important;
    font-style: italic !important;
}

/* ============ Cell Selection Styles for Drag-Fill ============ */

/* Selected cell styling */
.selected-cell {
    position: relative !important;
    background-color: rgba(0, 120, 212, 0.05) !important;
}

.selected-cell::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border: 2px solid #0078d4;
    pointer-events: none; /* Ensure this doesn't block clicks */
    z-index: 1; /* Lower z-index to not interfere with input */
}

/* Anchor cell (first selected cell) styling */
.anchor-cell {
    position: relative !important;
    box-shadow: inset 0 0 0 2px #0078d4 !important;
}

.anchor-cell::before {
    content: '';
    position: absolute;
    bottom: -3px;
    right: -3px;
    width: 7px;
    height: 7px;
    background-color: #0078d4;
    border: 1px solid white;
    cursor: crosshair;
    z-index: 1000;
    pointer-events: none; /* Don't block clicks on the input */
}

/* Fill preview styling */
.fill-preview-cell {
    background-color: rgba(0, 120, 212, 0.1) !important;
    border: 1px dashed #0078d4 !important;
    position: relative;
}

/* Removed unused selection animation to prevent any potential animation issues */

/* Drag cursor */
.grid-container.dragging-fill {
    cursor: crosshair !important;
}

.grid-container.dragging-fill * {
    cursor: crosshair !important;
}

/* Disable text selection during drag operations */
.custom-data-cell.selecting {
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

/* Fill handle (small square at bottom-right of anchor cell) */
.fill-handle {
    position: absolute;
    width: 7px;
    height: 7px;
    background-color: #0078d4;
    border: 1px solid white;
    cursor: crosshair;
    z-index: 1000;
    bottom: -4px;
    right: -4px;
}

.fill-handle:hover {
    background-color: #106ebe;
    transform: scale(1.2);
}

/* Fill direction indicators */
.fill-direction-indicator {
    position: absolute;
    pointer-events: none;
    z-index: 999;
}

.fill-direction-indicator.down::after {
    content: '↓';
    position: absolute;
    bottom: -20px;
    right: 50%;
    transform: translateX(50%);
    font-size: 20px;
    color: #0078d4;
}

.fill-direction-indicator.up::after {
    content: '↑';
    position: absolute;
    top: -20px;
    right: 50%;
    transform: translateX(50%);
    font-size: 20px;
    color: #0078d4;
}

.fill-direction-indicator.right::after {
    content: '→';
    position: absolute;
    right: -20px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 20px;
    color: #0078d4;
}

.fill-direction-indicator.left::after {
    content: '←';
    position: absolute;
    left: -20px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 20px;
    color: #0078d4;
}

/* Phase 2: Fill Handle Styles */

/* Fill handle - small square in bottom-right corner of anchor cell */
.fill-handle {
    position: absolute;
    width: 7px;
    height: 7px;
    background-color: #0078d4;
    border: 1px solid white;
    right: -4px;
    bottom: -4px;
    cursor: crosshair;
    z-index: 100;
    transition: transform 0.15s ease-in-out;
}

/* Fill handle hover effect */
.fill-handle:hover {
    transform: scale(1.3);
    background-color: #106ebe;
}

/* Fill preview cells - cells that will be filled */
.fill-preview-cell {
    background-color: rgba(0, 120, 212, 0.1) !important;
    border: 1px dashed #0078d4 !important;
    position: relative;
}

/* Visual feedback during fill drag */
.fill-preview-cell::after {
    content: '';
    position: absolute;
    inset: 0;
    /* Use a simple solid overlay instead of gradient pattern to avoid optical illusion */
    background: rgba(0, 120, 212, 0.08);
    pointer-events: none;
}

/* Cursor changes during drag operations */
body.is-dragging-fill {
    cursor: crosshair !important;
}

body.is-dragging-fill * {
    cursor: crosshair !important;
}

/* Enhance cell hover effect during fill drag */
.custom-data-cell:hover.fill-preview-cell {
    background-color: rgba(0, 120, 212, 0.2) !important;
    border-color: #106ebe !important;
}

/* Direction indicators for fill operation - Vertical Only */
.fill-direction-down::before {
    content: '↓';
    position: absolute;
    right: 5px;
    bottom: 5px;
    color: #0078d4;
    font-size: 14px;
    font-weight: bold;
    pointer-events: none;
}

.fill-direction-up::before {
    content: '↑';
    position: absolute;
    right: 5px;
    top: 5px;
    color: #0078d4;
    font-size: 14px;
    font-weight: bold;
    pointer-events: none;
}

/* Horizontal directions not used - only vertical fill is supported
.fill-direction-right::before {
    content: '→';
    position: absolute;
    right: 5px;
    bottom: 50%;
    transform: translateY(50%);
    color: #0078d4;
    font-size: 14px;
    font-weight: bold;
    pointer-events: none;
}

.fill-direction-left::before {
    content: '←';
    position: absolute;
    left: 5px;
    bottom: 50%;
    transform: translateY(50%);
    color: #0078d4;
    font-size: 14px;
    font-weight: bold;
    pointer-events: none;
} */
